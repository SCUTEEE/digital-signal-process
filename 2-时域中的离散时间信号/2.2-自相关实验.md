---
title: è‡ªç›¸å…³å®éªŒ
---

<!--more-->
$$
\begin{align*}
\newcommand{\dif}{\mathop{}\!\mathrm{d}}
\newcommand{\belowarrow}[1]{\mathop{#1}\limits_{\uparrow}}
\newcommand{\bd}{\boldsymbol}
\newcommand{\L}{\mathscr{L}}
\end{align*}
$$

> è®²çœŸæˆ‘è§‰å¾—è¿™ä¸ªå®éªŒè€å¸ˆæ²¡è®²ä»€ä¹ˆæœ‰ç”¨çš„ã€‚

# å®éªŒè¦æ±‚

1. ç¼–å†™ä¸€ä¸ªé¢‘ç‡å¯è°ƒã€å£°éŸ³å¤§å°å¯è°ƒçš„å‡½æ•°ï¼Œèƒ½äº§ç”Ÿ20Hzåˆ°20kHzçš„å“åº¦å¯è°ƒçš„å•é¢‘å£°éŸ³ä¿¡å·
2. ç¼–å†™ä¸€ä¸ªé¢‘ç‡èŒƒå›´å¯è°ƒ, å¹…åº¦/æ—¶é•¿å¯è°ƒçš„å‡½æ•°, èƒ½äº§ç”Ÿåœ¨20Hzåˆ°20KHzçš„èŒƒå›´å†…çš„çº¿æ€§è°ƒé¢‘ä¿¡å·ï¼Œä¿¡å·å½¢å¼å¦‚ä¸‹ï¼š
    
    $$
    x[nT]=\exp (j2\pi f_c nT + j \pi \mu (nT)^2)
    $$

    $f_c$ æ˜¯ä¸­å¿ƒé¢‘ç‡ï¼Œ$T$ æ˜¯é‡‡æ ·é—´éš”ï¼Œ$\mu$ æ˜¯è°ƒé¢‘ç‡
3. å°†äº§ç”Ÿçš„çº¿å½¢è°ƒé¢‘ä¿¡å·ä½œä¸ºè¾“å…¥ï¼Œå¹¶åšçº¿æ€§å»¶æ—¶ç›¸åŠ è¿ç®—ï¼Œç„¶ååˆ©ç”¨äº’ç›¸å…³å¯¹å»¶æ—¶ä¿¡å·è¿›è¡Œå»¶æ—¶ä¼°è®¡ï¼Œè§‚å¯Ÿä¸åŒé¢‘å®½ã€æ—¶é•¿çº¿æ€§è°ƒé¢‘ä¿¡å·çš„ä¼°è®¡ç²¾åº¦å·®åˆ«ã€‚

# å®éªŒè¿‡ç¨‹

&emsp;&emsp;è¦æ±‚1. å¾ˆç®€å•ï¼Œç”¨æ­£å¼¦å‡½æ•°å³å¯ï¼Œæˆ‘ä»¬è¦æ³¨æ„çš„æ˜¯é‡‡æ ·ç‡ã€‚matlab ä¸­ `sound` å‡½æ•°å¯¹é‡‡æ ·ç‡çš„è§„å®šå¦‚ä¸‹ï¼š

```matlab
sound(y) % ä»¥é»˜è®¤é‡‡æ ·ç‡ 2^13=8192 èµ«å…¹å‘æ‰¬å£°å™¨å‘é€éŸ³é¢‘ä¿¡å· yã€‚

sound(y,Fs) % ä»¥é‡‡æ ·ç‡ Fs å‘æ‰¬å£°å™¨å‘é€éŸ³é¢‘ä¿¡å· yã€‚

sound(y,Fs,nBits) % å¯¹éŸ³é¢‘ä¿¡å· y ä½¿ç”¨ nBits çš„é‡‡æ ·ä½æ•°ã€‚

%é™„ï¼šé‡‡æ ·ç‡æœ€å°ä¸º 1000Hz
```

&emsp;&emsp;æ‰€ä»¥å®¹æ˜“å†™å‡º `soundgen`ï¼ˆsound generatorï¼‰ï¼š

```matlab
function y = soundgen(A,f,n,fs)
    y = A*sin(2*pi*f*n/fs);
    sound(y, fs);
end
```

&emsp;&emsp;æˆ‘ä»¬æ¥äº§ç”Ÿä¸€ä¸ªä¸­å¤®Cï¼ˆdo~ğŸµï¼‰ï¼š

```matlab
soundgen(1,261.6,1000,1000);
```

&emsp;&emsp;è®©æˆ‘ä»¬æ¥å”±ä¸€ä¸‹å°æ˜Ÿæ˜Ÿï¼ˆè«æ‰ç‰¹çš„å°æ˜Ÿæ˜Ÿå˜å¥æ›²ğŸµï¼‰ï¼š

```matlab
little_star_right=[1 1 5 5 6 6 5 5 4 4 3 3 2 3 1];
little_star_left=[1 8 10 8 11 8 10 8 9 7 8 6 4 5 1];
notes = [1 3 5 6 8 10 12 13 15 17 18 20];
for note = 1:15
    r = 220*2.^((notes(little_star_right(note))+2)./12);
    l = 220*2.^((notes(little_star_left(note))-10)./12);
    soundgen(1,r,1024,2048);
    soundgen(0.3,l,1024,2048);
    pause(0.5)
end
```

&emsp;&emsp;å¯ä»¥å¬ä¸€ä¸‹åŸæ›²ï¼š

<div>{%- include extensions/bilibili.html id='3033530' -%}</div>

&emsp;&emsp;è¿˜æ˜¯å·®å¾ˆå¤šï¼Œå› ä¸ºé’¢ç´è¿˜æœ‰ä¸€äº›æ³›éŸ³å•¥çš„ï¼Œæ‰€ä»¥å¬èµ·æ¥ä¼šå¥½å¬å¾ˆå¤šã€‚

&emsp;&emsp;ç­‰ä¼šå„¿ï¼Œä¸æ˜¯è¦å¼„è‡ªç›¸å…³å—ï¼Ÿæ€ä¹ˆè·‘åäº†ï¼Ÿï¼Ÿï¼Ÿè®©æˆ‘ä»¬ä¸€è¾¹å¬ç€å°æ˜Ÿæ˜Ÿä¸€è¾¹å†™ä¸‹é¢çš„å†…å®¹å§ï¼

&emsp;&emsp;ä¸‹ä¸€ä¸ªæ˜¯è°ƒé¢‘ä¿¡å·ï¼Œé¢˜ç›®ä¸­ç»™çš„å…¬å¼æ˜¯ä¸€ç±»ç‰¹å®šçš„è°ƒé¢‘ä¿¡å·ï¼Œå«ä½œ **çº¿æ€§è°ƒé¢‘ï¼ˆLinear Frequency Modulatedï¼‰ä¿¡å·**ï¼Œå…¶å®šä¹‰å¼å¦‚ä¸‹ï¼š

$$
x(t)=\exp (j2\pi f_c t + j \pi \mu t^2)
$$

&emsp;&emsp;é€šè¿‡å¯¹ç›¸ä½è¿›è¡Œå¾®åˆ†ï¼Œå¯ä»¥æ±‚å‡ºå…¶é¢‘ç‡ä¸ºï¼š

$$
\frac{1}{2\pi} \frac{\dif \theta}{\dif t} = f_c+\mu t
$$

&emsp;&emsp;å…¶é¢‘ç‡ä¼šéšæ—¶é—´å˜å¤§è€Œå˜å¤§ï¼Œ$\mu$ å¯ä»¥çœ‹åšæ˜¯â€œæ–œç‡â€ã€‚

```matlab
function [x,xn] = LFM(A, fc, u, T, n1, n2)
%generate signal: A*exp(j*2*pi*fc*n*T+j*pi*u*(n*T)^2)
% A  = amplitude
% fc = center frequence
% u  = slope
% T  = sampling time
% n1 = start time
% n2 = end time

    xn=[n1:n2];
    x=A*exp(1i*2*pi*fc*xn*T+1i*pi*u*(xn*T).^2);

end
```

```matlab
%ä¸ºäº†æ–¹ä¾¿çœ‹ï¼Œç›¸ä½å°±ä»0å¼€å§‹
[x,xn]=LFM(1, 0, 100, 0.001, 0, 300);
plot(xn,real(x),'b')

%ä¸ºäº†å¥½ç©ï¼Œå¯ä»¥å¬ä¸€ä¸‹è¿™ä¸ªå£°éŸ³
%[x,xn] = LFM(1, 20, 100, 0.001, 0, 3000);
%sound(real(x),1000)
```

<center><img title="LTM1.jpg" src="https://i.loli.net/2020/11/04/BbQzlwkctsCVeRA.jpg" width="800"></center>

&emsp;&emsp;é¡ºä¾¿æä¸€å¥ï¼Œç”±äºé¢‘ç‡æ˜¯ä¸æ–­å‡é«˜çš„ï¼Œæ‰€ä»¥é‡‡æ ·é¢‘ç‡åˆ°åé¢æ˜¯ä¸å¤Ÿçš„ï¼Œå¦‚æœåé¢å‡ºç°äº†ä¸€äº›â€œå‘¨æœŸæ€§â€çš„å›¾æ¡ˆï¼Œå¯ä»¥è°ƒå° $\mu$ æˆ–è°ƒå¤§é‡‡æ ·é¢‘ç‡ã€‚

&emsp;&emsp;ç„¶åæˆ‘ä»¬å¯¹ä¿¡å·è¿›è¡Œçº¿æ€§å»¶æ—¶ç›¸åŠ ï¼šï¼ˆåˆ©ç”¨ä¹‹å‰å®šä¹‰è¿‡çš„ sigadd å’Œ sigshiftï¼Œè¿™é‡Œå†å†™ä¸€æ¬¡ï¼‰

```matlab
function [y,n] = sigadd(x1,n1,x2,n2)
% implements y(n) = x1(n) + x2(n)
% y = sum sequence over n, which includes n1 and n2
% x1 = first sequence over n1
% x2 = second sequence over n2
% åŠ æ³•å™¨

    n = min(min(n1),min(n2)):max(max(n1),max(n2));
    y1 = zeros(1,length(n));
    y2 = y1;
    y1(find((n>=min(n1))&(n<=max(n1))==1))=x1;
    y2(find((n>=min(n2))&(n<=max(n2))==1))=x2;
    y = y1+y2;

end
```

```matlab
function [y,n] = sigshift(x,m,k)
% implement y(n) = x(n-k)
% å»¶æ—¶å™¨

    n = m+k;
    y = x;

end
```

&emsp;&emsp;æˆ‘ä»¬å¯¹ä¿¡å·åˆ†åˆ«å»¶æ—¶ 50 å’Œ -100ï¼Œç„¶åå°†ä¸¤ä¸ªå»¶æ—¶ä¿¡å·ç›¸åŠ ï¼š

```matlab
[y1, yn1] = sigshift(x, xn, 50);
[y2, yn2] = sigshift(x, xn, -100);
[y yn] = sigadd(y1*0.5,yn1,y2*2,yn2);
```

&emsp;&emsp;ç„¶åç»ˆäºè¿æ¥æœ€é‡è¦çš„è‡ªç›¸å…³å•¦ï¼matlab ä¸­å·²ç»æœ‰ç°æˆçš„ `xcorr` å¯ç”¨ï¼Œæƒ³è¦æŒ‘æˆ˜è‡ªæˆ‘çš„åŒå­¦ä¹Ÿå¯ä»¥æ ¹æ®å®šä¹‰å†™ä¸€ä¸ªè‡ªç›¸å…³ã€‚

```matlab
function [z,zn] = myxcorr(x,xn,y,yn)
% calculate xcorr(x,y)
    
    %å°†ä¸¤ä¸ªä¿¡å·è¡¥é›¶åˆ°ç›¸åŒé•¿åº¦
    n = min(min(xn),min(yn)):max(max(xn),max(yn));
    x1 = zeros(1,length(n));
    y1 = x1;
    x1(find((n>=min(xn))&(n<=max(xn))==1))=x;
    y1(find((n>=min(yn))&(n<=max(yn))==1))=y;
    
    z = xcorr(x1,y1);
    zn = [-length(n)+1:length(n)-1];
end
```

```matlab
[z,zn]=myxcorr(y,yn,x,xn);
plot(zn,z);
```

<center><img title="xcorr_experiment.jpg" src="https://i.loli.net/2020/11/04/rfOo38dYAXRZp46.jpg" width="800"></center>

&emsp;&emsp;ä»å›¾ä¸­å¯ä»¥ä¼°ç®—ä¿¡å·åˆ†åˆ«æ—¶ç§»äº† -100 å’Œ 50ï¼Œä¸å®é™…å»åˆã€‚

<!-- [x,xn]=LFM(1, 0, 500, 0.001, 0, 300);
plot(xn,real(x),'b')
[y1, yn1] = sigshift(x, xn, 50);
[y2, yn2] = sigshift(x, xn, -100);
[y yn] = sigadd(y1*0.5,yn1,y2*2,yn2);
[z,zn]=myxcorr(y,yn,x,xn);
plot(zn,z); -->