---
title: ç¦»æ•£å‚…é‡Œå¶å˜æ¢å®éªŒ
---

<!--more-->
$$
\begin{align*}
\newcommand{\dif}{\mathop{}\!\mathrm{d}}
\newcommand{\belowarrow}[1]{\mathop{#1}\limits_{\uparrow}}
\newcommand{\bd}{\boldsymbol}
\newcommand{\L}{\mathscr{L}}
\newcommand{\xleftrightarrow}[1]{\stackrel{#1}{\longleftrightarrow}}
\end{align*}
$$

# å®éªŒè¦æ±‚

1. éªŒè¯æ€§å®éªŒ
   * ç”¨ Matlab éªŒè¯DFTè¿ç®—çš„å¯¹ç§°æ€§è´¨
   * ç¼–ç¨‹è®¡ç®—å‡ºä¸€ä¸ª2Nç‚¹çš„å®åºåˆ—çš„é¢‘è°±ï¼Œè¦æ±‚åªä½¿ç”¨ä¸€æ¬¡ N ç‚¹çš„ FFT å’Œå…¶ä»–è¿ç®—ï¼Œå¹¶ä¸ä¸€æ¬¡ 2N ç‚¹ FFT ä½œå‡ºçš„é¢‘è°±è¿›è¡Œæ¯”è¾ƒéªŒè¯
2. åº”ç”¨æ€§å®éªŒ
   * å»ä¸­å›½æœŸåˆŠç½‘ã€IEEEç½‘ç«™ç­‰æŸ¥æ‰¾é¢‘ç‡ä¼°è®¡æ–¹æ³•ï¼Œåˆ©ç”¨è‡³å°‘ä¸¤ç§é¢‘ç‡ä¼°è®¡æ–¹æ³•ç¼–ç¨‹æ±‚ç»™å®šä¿¡å·çš„é¢‘ç‡ ï¼Œè¦æ±‚ï¼š
     * æ‰€æœ‰ç®—æ³•ä½¿ç”¨ç›¸åŒç‚¹æ•°çš„FFTï¼ˆå°äºç­‰äº100ç‚¹ï¼‰
     * æ— å™ªå£°ã€20dBã€10dBã€5dBã€0dBã€-5dBï¼Œæ¯ä¸ªä¿¡å™ªæ¯”è‡³å°‘100æ¬¡ï¼ˆæ— å™ªå£°é™¤å¤–ï¼‰
     * ç»˜å‡ºä¼°è®¡å‡æ–¹è¯¯å·®å›¾
     * ä¿¡å·æ¥æºï¼šç”¨é‡‡æ ·ç‡8000Hzï¼Œå¯¹é¢‘ç‡ä¸º350Hzçš„å•é¢‘æ­£å¼¦ä¿¡å·è¿›è¡Œé‡‡æ ·ï¼Œå–70ä¸ªç‚¹ä½œä¸ºåŸå§‹ä¿¡å·ï¼ˆæ— å™ªå£°ï¼‰
   * çº¿æ€§è°ƒé¢‘ä¿¡å·LFMï¼š $x(nT)=\exp(j2\pi f_0 nT+j \pi u (nT)^2)$ï¼Œ$f_0$ ä¸ºä¸­å¿ƒé¢‘ç‡ï¼Œ$T$ ä¸ºä¿¡å·é‡‡æ ·é—´éš”ï¼Œ$u$ ä¸ºè°ƒé¢‘ç‡ï¼Œè¦æ±‚ï¼š
     * åœ¨LFMä¿¡å·ä¸­åŠ å…¥å™ªå£°ä¿¡å· $n(t)$,é‡‡ç”¨åŒ¹é…æ»¤æ³¢å™¨çš„æ–¹æ³•å¯¹LFMä¿¡å·è¿›è¡Œè„‰å†²å‹ç¼©ï¼Œå¹¶è§‚å¯Ÿæ•ˆæœã€‚$h(t)=s^*(t_0-t)$
     * æŸ¥é˜…æ–‡çŒ®ï¼Œä¸åŒç±»å‹çš„å¤±é…æ»¤æ³¢å™¨ï¼Œå¹¶ç”¨å…¶å¯¹LFMä¿¡å·è¿›è¡Œè„‰å†²å‹ç¼©ï¼Œå¹¶è§‚å¯Ÿæ•ˆæœã€‚

# å®éªŒè¿‡ç¨‹

## éªŒè¯DFTçš„å¯¹ç§°æ€§è´¨

DFT çš„å¯¹ç§°æ€§è´¨åŒ…æ‹¬ï¼š

|åºåˆ—|DFT|
|---|---|
|$x[n]=x_\text{re}[n]+j x_\text{im}[n]$|$X[k]=X_\text{re}[k]+j X_\text{im}[k]$|
|$x^*[n]$|$X^*[\langle-k\rangle_N]$|
|$x^*[\langle-n\rangle_N]$|$X^*[k]$|
|$x_\text{re}[n]$|$X_\text{cs} =\frac{1}{2} \{ X[k]+X^*[\langle -k \rangle_N] \}$|
|$j x_\text{im}[n]$|$X_\text{ca}[k]=\frac{1}{2} \{ X[k]-X^*[\langle -k \rangle_N] \}$|
|$x_\text{cs}[n]$|$X_\text{re}[k]$|
|$x_\text{ca}[n]$|$jX_\text{im}[k]$|

ç”±å…±è½­å¯¹ç§°æ€§å¯ä»¥æ¨å¯¼å‡ºåé¢å››æ¡å¼å­ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéªŒè¯åé¢ä¸¤æ¡å¼å­ã€‚æˆ‘ä»¬ä½¿ç”¨çš„ $x[n]$ ä¸ºï¼š

$$
\begin{bmatrix}
4j & 1+3j & 2+2j & 3+j & 4
\end{bmatrix}
$$

ä¸ºäº†æ–¹ä¾¿ä½œå›¾ï¼Œæˆ‘ä»¬å®šä¹‰ `dftplot.m` å¦‚ä¸‹ï¼š

```matlab
function dftplot(xn)
%plot xn and Xk
    N = length(xn);
    n = 0:(N-1);
    Xk = fft(xn);

    subplot(321);
    stem(n, real(xn));
    title('real of x_n');
    xlabel('n');

    subplot(322);
    stem(n,imag(xn));
    title('image of x_n');
    xlabel('n');

    subplot(323);
    stem(n, abs(Xk));
    title('abs of X_k');
    xlabel('k');

    subplot(324);
    stem(n, angle(Xk));
    title('angle of X_k');
    xlabel('k');

    subplot(325);
    stem(n, real(Xk));
    title('real of X_k');
    xlabel('k');

    subplot(326);
    stem(n, imag(Xk));
    title('image of X_k');
    xlabel('k');
end
```

ç„¶åæˆ‘ä»¬æ±‚ $x_\text{cs}$ å’Œ $x_\text{ca}$ï¼Œæˆ‘ä»¬å®šä¹‰ `csca.m` å¦‚ä¸‹ï¼š

```matlab
function [x_cs,x_ca] = csca(x)
%computes x_cs and x_ca of x
    N = length(x);
    n = [0:N-1];
    xc = conj(x(mod(-n, N)+1));
    x_cs = 0.5*(x + xc);
    x_ca = 0.5*(x - xc);
end
```

åˆ©ç”¨è¿™ä¸ªæ±‚å‡º $x_\text{cs}$ å’Œ $x_\text{ca}$ï¼Œå¹¶ä½œå‡ºå›¾åƒï¼š

```
x = [4j 1+3j 2+2j 3+j 4];
[x_cs,x_ca] = csca(x);
dftplot(x);
figure;
dftplot(x_cs);
figure;
dftplot(x_ca);
```

<!-- ![dsp_exp2_112](/assets/images/dsp_exp2_111.jpg)

![dsp_exp2_112](/assets/images/dsp_exp2_112.jpg)

![dsp_exp2_113](/assets/images/dsp_exp2_113.jpg) -->

|$x[n]$|$x_\text{cs}[n]$|$x_\text{ca}[n]$|
|------|---------|---------|
|![dsp_exp2_111](https://i.loli.net/2020/11/30/GnCWIYVQ6ymtoMR.jpg)|![dsp_exp2_112](https://i.loli.net/2020/11/30/4cO6gofbGmNXxup.jpg)|![dsp_exp2_113](https://i.loli.net/2020/11/30/Eyc8JahfDQSYKj6.jpg)|

è§‚å¯Ÿæœ€åä¸€è¡Œå¯ä»¥å‘ç°ï¼Œ$x_\text{cs}[n]$ çš„ DFT ä¸º $X_\text{re}[k]$ï¼Œ$x_\text{ca}[n]$ çš„ DFT ä¸º $X_\text{im}[k]$ã€‚

ä»¿ç…§ä¸Šé¢çš„è¿‡ç¨‹ï¼Œå¯ä»¥è¯æ˜ $x_\text{re}[n]$ çš„ DFT ä¸º $X_\text{cs}[k]$ï¼Œ$x_\text{im}[n]$ çš„ DFT ä¸º $X_\text{ca}[k]$ã€‚å…ˆå®šä¹‰ `idftplot.m`ï¼Œæ–¹ä¾¿åé¢ä½œå›¾ï¼š

```matlab
subplot(321);
    stem(n, real(xn));
    title('real of x_n');
    xlabel('n');

    subplot(322);
    stem(n,imag(xn));
    title('image of x_n');
    xlabel('n');

    subplot(323);
    stem(n, abs(Xk));
    title('abs of X_k');
    xlabel('k');

    subplot(324);
    stem(n, angle(Xk));
    title('angle of X_k');
    xlabel('k');

    subplot(325);
    stem(n, real(Xk));
    title('real of X_k');
    xlabel('k');

    subplot(326);
    stem(n, imag(Xk));
    title('image of X_k');
    xlabel('k');
```

ç„¶åæ±‚å‡º $X_\text{cs}$ å’Œ $X_\text{ca}$ï¼Œå¹¶ä½œå‡ºå›¾åƒï¼š

```matlab
X = fft(x);
[X_cs, X_ca] = csca(X);
idftplot(X)
figure;
idftplot(X_cs);
figure;
idftplot(X_ca);
```

<!-- ![dsp_exp2_114](/assets/images/dsp_exp2_111.jpg)

![dsp_exp2_115](/assets/images/dsp_exp2_115.jpg)

![dsp_exp2_116](/assets/images/dsp_exp2_116.jpg) -->

|$X[k]$|$X_\text{cs}[k]$|$X_\text{ca}[k]$|
|------|---------|---------|
|![dsp_exp2_111](https://i.loli.net/2020/11/30/GnCWIYVQ6ymtoMR.jpg)|![dsp_exp2_115](https://i.loli.net/2020/11/30/Qtqg7fTMFlYniAh.jpg)|![dsp_exp2_116](https://i.loli.net/2020/11/30/IMcOnQ8CiXy7F2b.jpg)|

æ³¨æ„ç¬¬ä¸€è¡Œï¼Œ$x_\text{re}[n]$ çš„ DFT ä¸º $X_\text{cs}[k]$ï¼Œ$x_\text{im}[n]$ çš„ DFT ä¸º $X_\text{ca}[k]$ã€‚

ç»¼ä¸Šï¼Œå¯ä»¥éªŒè¯ DFT çš„å¯¹ç§°æ€§è´¨æˆç«‹ã€‚

## åˆ©ç”¨nç‚¹DFTæ±‚2nç‚¹å®åºåˆ—DFT

æ±‚è§£è¿‡ç¨‹å¦‚ä¸‹ï¼š

```matlab
function Xk = nfft(xn)
    N = length(xn);
    n = 0:(N-1);

    if mod(N,2) ~= 0
        error('the length of xn must be 2n')
    end

    gn = xn(2:2:N); %å¶æ•°
    hn = xn(1:2:N); %å¥‡æ•°

    yn = gn+1i*hn; %å¶æ•°ä½œä¸ºå®éƒ¨ï¼Œå¥‡æ•°ä½œä¸ºè™šéƒ¨
    Yk = fft(yn); %è®¡ç®— fft
    [Gk,Hk] = csca(Yk); %åˆ†è§£ä¸ºå…±è½­å¯¹ç§°ä¸å…±è½­åå¯¹ç§°
    Hk = Hk./1i;
    Xk = Hk(mod(n,N/2)+1)+exp(-1i*2*pi*n/N).*Gk(mod(n,N/2)+1); %æ±‚å‡ºæœ€åçš„ Xk
end
```

å°†ä¸Šè¿°ä»£ç ä¿å­˜ä¸º `nfft.m`ï¼Œç„¶åä¸ matlab è‡ªå¸¦çš„ fft è¿›è¡Œå¯¹æ¯”ï¼š

```matlab
x = [1 2 3 4 5 6];
X_fft = fft(x)
X_nfft = nfft(x)
```

è¾“å‡ºçš„ç»“æœä¸ºï¼š

```matlab
X_fft =

  1 è‡³ 3 åˆ—

  21.0000 + 0.0000i  -3.0000 + 5.1962i  -3.0000 + 1.7321i

  4 è‡³ 6 åˆ—

  -3.0000 + 0.0000i  -3.0000 - 1.7321i  -3.0000 - 5.1962i


X_nfft =

  1 è‡³ 3 åˆ—

  21.0000 + 0.0000i  -3.0000 + 5.1962i  -3.0000 + 1.7321i

  4 è‡³ 6 åˆ—

  -3.0000 - 0.0000i  -3.0000 - 1.7321i  -3.0000 - 5.1962i
```

ä¸¤ä¸ªç»“æœä¸€è‡´ï¼Œè¯´æ˜å¯ç”¨ å•ä¸ª N ç‚¹ DFT è®¡ç®—ä¸€ä¸ªå®åºåˆ—çš„ 2N ç‚¹ DFT.

## ä¿¡å·é¢‘ç‡ä¼°è®¡

ç”¨é‡‡æ ·ç‡8000Hzï¼Œå¯¹é¢‘ç‡ä¸º350Hzçš„å•é¢‘æ­£å¼¦ä¿¡å·è¿›è¡Œé‡‡æ ·ï¼Œå–70ä¸ªç‚¹ä½œä¸ºåŸå§‹ä¿¡å·ï¼š

```matlab
fs = 8000;
f=350;
n = 0:69;
x = sin(2*pi*f*n./fs);
```

åŠ å…¥å™ªå£°ã€‚æ ¹æ®æœç´¢åˆ°çš„èµ„æ–™ï¼Œå¯ä»¥ä½¿ç”¨ matlab å†…ç½®çš„å‡½æ•° `awgn.m` æ¥åŠ å…¥é«˜æ–¯ç™½å™ªå£°ï¼š

```matlab
x_noise = awgn(x,20,'measured');
```

ä¸ºäº†æ–¹ä¾¿åç»­è¿›è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼ˆ`FT.m`ï¼ŒFrequent Testï¼‰ï¼Œè¾“å…¥é¢‘ç‡ä¼°è®¡æ–¹æ³•ï¼Œè¾“å‡ºç›¸åº”çš„å‡æ–¹è¯¯å·®ï¼š

```matlab
function mse_result = FT(freq, x, snr, func,varargin)
%use func to estimate the frequent of a noise-corrupted signal, and compare it to the original freq, return mean-square-error of the estimation
% freq = original frequent
% x = original signal
% snr = sign noise ratio
% func = estimation function
% test_times = the times of test

    if ~exist('test_times', 'var') || isempty(test_times)
        % test_times å‚æ•°ä¸ºç©ºï¼Œæˆ–è€…ä¸ä»¥å˜é‡çš„å½¢å¼å­˜åœ¨ï¼›
        test_times=100;
    end

    if ~exist('fs', 'var') || isempty(fs)
        % test_times å‚æ•°ä¸ºç©ºï¼Œæˆ–è€…ä¸ä»¥å˜é‡çš„å½¢å¼å­˜åœ¨ï¼›
        test_times=100;
    end
    
    errors = zeros(1,test_times);
    for k = [1:test_times]
        x_noise = awgn(x, snr, 'measured');
        f_estimate = func(x_noise, fs);
        errors(k) = [errors f_estimate-freq];
    end
    mse_result = sum(errors.^2) / test_times;
end
```

ä¸‹é¢æ¥è®¨è®ºä¸åŒçš„é¢‘ç‡ä¼°è®¡æ–¹æ³•ã€‚é¦–å…ˆï¼Œæœ€ç®€å•çš„ï¼Œå°±æ˜¯ç›´æ¥æ±‚å‡º DFT æœ€å¤§å€¼å¤„å¯¹åº”çš„é¢‘ç‡ï¼ˆå‡†ç¡®æ¥è¯´ï¼Œæ˜¯ DFT å‰ $N/2$ ä¸ªç‚¹ä¸­æœ€å¤§å€¼ï¼‰ï¼Œè¿™ç§°ä¸ºè°±å³°æ³•ã€‚

```matlab
function f_estm = f_estm_fft(xn, fs)
    Xk = abs(fft(xn));
    N = length(xn);
    [M,I]=max(Xk(1:ceil(N/2)));
    f_estm = (N/2-abs(N/2-(I-1)))*fs/N; %matlab ç¼–å·ä»1å¼€å§‹ï¼Œæ•…è¦å‡å»1
end
```

æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼ˆåé¢çš„æµ‹è¯•ä»£ç éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œåªéœ€è¦ä¿®æ”¹ test å¯¹åº”çš„å‡½æ•°å³å¯ï¼‰

```
snr_array = [-5 0 5 10 20 inf];
errors = [];
test = @f_estm_fft;
for snr=snr_array
    errors = [errors log(FT(f, x, snr, test, 'fs',8000, 'test_times',1000))];
end
stem([-5 0 5 10 20 40], errors)
xlabel('snr/dB');
ylabel('log(mse)');
set(gca,'xtick',[-5 0 5 10 20 40]);
set(gca,'xticklabel',{'-5', '0', '5','10','20','inf'});
```

ä»ä¸‹é¢çš„å‡æ–¹è¯¯å·®å›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¿¡å™ªæ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œå‡æ–¹è¯¯å·®å¤§çº¦åœ¨ 4 å·¦å³ï¼Œè€Œå½“ä¿¡å™ªæ¯”è¾ƒå¤§æ—¶ï¼Œå‡æ–¹è¯¯å·®å°±ä¼šå‡é«˜ï¼š

![dftä¼°è®¡é¢‘ç‡](https://i.loli.net/2020/12/01/4SVLEfGxo9RqnIZ.jpg)

---

ä¸Šé¢çš„ä¼°è®¡å¾ˆç®€å•ï¼Œä½†å­˜åœ¨ä¸€å®šè¯¯å·®ã€‚å‡è®¾ DFT å¹…åº¦æœ€å¤§å€¼çš„ä¸‹æ ‡ä¸º $k_p$ï¼Œé‚£ä¹ˆå®é™…é¢‘ç‡å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$
f = \frac{k_p+\delta}{N} f_s
$$

æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æ±‚å‡º $\delta$ã€‚å¸¸ç”¨çš„æ–¹æ³•æœ‰ï¼šmusicç®—æ³•ï¼Œrifeç®—æ³•ï¼Œå‘¨æœŸå›¾æ³•ï¼Œpisarenko,levensonæ³•ã€‚ä¸‹é¢åˆ©ç”¨ rife ç®—æ³•ï¼Œå…¶è¡¨è¾¾å¼å¦‚ä¸‹ï¼š

$$
\delta = 
\begin{cases}
  \dfrac{| X(k_p+1)|}{|X(k_p+1)|+|X(k_p)|}ï¼Œ|X(k_p+1)|>|X(k_p-1)|\\
  \dfrac{-| X(k_p-1)|}{|X(k_p-1)|+|X(k_p)|}ï¼Œ|X(k_p+1)|\leq |X(k_p-1)|
\end{cases}
$$

```matlab
function f_estm = f_estm_rife(xn, fs)
    Xk = abs(fft(xn));
    N = length(xn);
    [M,k0]=max(Xk(1:ceil(N/2)));
    
    p0=abs(Xk(k0));
    p1=abs(Xk(k0-1));
    p2=abs(Xk(k0+1));
    if p1>=p2
        pp=p1;flag=-1;
    else
        pp=p2;flag=1;
    end
    k=k0-1+flag*pp/(p0+pp);
    f_estm=k*fs/N;
end
```

ä½¿ç”¨ç›¸åŒçš„æµ‹è¯•ä»£ç å¾—åˆ°çš„å›¾åƒå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºåœ¨ä¿¡å™ªæ¯”è¶Šå¤§ï¼Œå…¶ä¼°è®¡çš„å‡†ç¡®åº¦è¶Šå¥½ã€‚

![rifeä¼°è®¡é¢‘ç‡](https://i.loli.net/2020/12/01/95evSh7dyfTaN6r.jpg)

---

å¦å¤–è¿˜ä½¿ç”¨è¯¾å ‚ä¸­æåˆ°çš„å¯¼æ•°æ³•ï¼Œå…¶å…¬å¼å¦‚ä¸‹ï¼š

$$
\hat{\omega_c} = \frac{\sum_{k=0}^{N-1}|X_k|^2 k\omega_0}{\sum_{k=0}^{N-1}|X_k|^2}\approx \frac{\sum_{k=k_0-\Delta}^{k_0+\Delta}|X_k|^2 k\omega_0}{\sum_{k=k_0-\Delta}^{k_0+\Delta}|X_k|^2}
$$

```matlab
function f_estm = f_estm_dif(xn, fs)
    Xk = abs(fft(xn));
    N = length(xn);
    [M,k0]=max(Xk(1:ceil(N/2)));
    Delta=4;
    num=0;
    den=0;
    for k = [k0-Delta:k0+Delta]
        if k<1 || k>N
            continue
        end
        num=num+abs(Xk(k))^2.*(k-1);
        den=den+abs(Xk(k))^2;
    end
    f_estm=num*fs/(den*N);
end
```

ä½¿ç”¨ç›¸åŒçš„æµ‹è¯•ä»£ç å¾—åˆ°çš„å›¾åƒå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹å‡ºå¯¼æ•°æ³•åœ¨å™ªå£°è¾ƒå¤§ä¸ rife æ³•ç±»ä¼¼ï¼Œè€Œåœ¨å™ªå£°è¾ƒå°æ—¶ä¸å¦‚ rife æ³•ï¼Œæ€»ä½“ä¸Šä»…æ¯”è°±å³°æ³•å¥½ä¸€ç‚¹ç‚¹ã€‚

![difä¼°è®¡é¢‘ç‡](https://i.loli.net/2020/12/01/6p5fycOrnB8wSTi.jpg)

æ€»ç»“ï¼šsnrâ‰¤5æ—¶éƒ½ä¸å¥½ï¼Œ-5<snr<10 æ—¶è°±å³°æ³•å¥½ï¼Œsnr>10æ—¶rifeæ³•å¥½å•ŠğŸ‘

## LFMè„‰å†²å‹ç¼©

è¯´çœŸçš„ï¼Œæˆ‘å‹æ ¹å°±ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆç©æ„ï¼Œä¹Ÿæ²¡æ—¶é—´æ…¢æ…¢æ¨å¯¼äº†ï¼Œå°±ç›´æ¥å‚è€ƒäº†è¿™ç¯‡æ–‡ç« ï¼š[çº¿æ€§è°ƒé¢‘ï¼ˆLFMä¿¡å·ï¼‰è„‰å†²å‹ç¼©é›·è¾¾matlabä»¿çœŸ](https://blog.csdn.net/weixin_44566643/article/details/107508520)ï¼Œä»¥åŠ [åŸºäºMATLABçš„çº¿æ€§è°ƒé¢‘ä¿¡å·çš„ä»¿çœŸ](https://wenku.baidu.com/view/2f8bb3df6429647d27284b73f242336c1eb93084.html)

å…ˆæ˜¯ç”Ÿæˆçº¿æ€§è°ƒé¢‘ä¿¡å·å¹¶åŠ å…¥å™ªå£°ï¼š

```matlab
%%çº¿æ€§è°ƒé¢‘ä¿¡å·
T=10e-6;                                  %pè„‰å†²æŒç»­æ—¶é—´10us
B=30e6;                                   %çº¿æ€§è°ƒé¢‘ä¿¡å·çš„é¢‘å¸¦å®½åº¦30MHz
K=B/T;                                      %è°ƒé¢‘æ–œç‡
Fs=2*B;Ts=1/Fs;                      %é‡‡æ ·é¢‘ç‡å’Œé‡‡æ ·é—´éš”
N=T/Ts;
t=linspace(-T/2,T/2,N);
St=exp(j*pi*K*t.^2);                    %çº¿æ€§è°ƒé¢‘ä¿¡å·
St=awgn(St,10);
subplot(211)
plot(t*1e6,real(St));
xlabel('æ—¶é—´/us');
title('çº¿æ€§è°ƒé¢‘ä¿¡å·çš„å®éƒ¨');
grid on;axis tight;
subplot(212)
freq=linspace(-Fs/2,Fs/2,N);
plot(freq*1e-6,fftshift(abs(fft(St))));
xlabel('é¢‘ç‡/MHz');
title('çº¿æ€§è°ƒé¢‘ä¿¡å·çš„å¹…é¢‘ç‰¹æ€§');
grid on;axis tight;
```

![LTM with noise](https://i.loli.net/2020/12/01/Rly8c4BndFosPEK.jpg)

```matlab
%% çº¿æ€§è°ƒé¢‘ä¸è„‰å†²å‹ç¼©
clear,clc,close all
set(0,'defaultfigurecolor','w')
%% Chirpä¿¡å·å‚æ•°è®¾ç½®
Tr = 10e-6;%æ—¶å®½
Br = 30e6;%å¸¦å®½
Fs = 2*Br;%é‡‡æ ·ç‡
%% Chirpä¿¡å·å‚æ•°å¯¼å‡º
Kr = Br/Tr;%è°ƒé¢‘ç‡
N =  round( Tr / (1/Fs) );%é‡‡æ ·ç‚¹æ•°
t = linspace( -Tr/2+0.1*Tr , Tr/2+0.1*Tr , N);%åœ¨[-Tp/2,Tp/2]é€‰å–é‡‡æ ·ç‚¹
%% Chirpä¿¡å·ç”Ÿæˆ
st = ( abs(t) < Tr/2 ) .* exp( 1j * pi * Kr * t.^2 );
st=awgn(st,10);
f_chirp= Kr * t; %ä¿¡å·é¢‘ç‡
phase_chirp = pi * Kr * t.^2;%ä¿¡å·ç›¸ä½
%% é¢‘è°±
freq = linspace(-Fs/2,Fs/2,N);%é¢‘åŸŸé‡‡æ ·
Sf = fftshift( fft(st) );
%% æ—¶åŸŸåŒ¹é…æ»¤æ³¢
ht = conj( fliplr(st) ); %æ—¶åŸŸåŒ¹é…æ»¤æ³¢ä¸ºå‘å°„ä¿¡å·æ—¶é—´åè¤¶å†å–å…±è½­
s1 = conv(st,ht); %çº¿æ€§è°ƒé¢‘ä¿¡å·ç»è¿‡åŒ¹é…æ»¤æ³¢å™¨åçš„è¾“å‡º(æ—¶åŸŸå·ç§¯)
N1 = N+N-1 ;%çº¿æ€§å·ç§¯åä¿¡å·é•¿åº¦å˜ä¸º N1+N2-1
t1 = linspace( -Tr/2 , Tr/2 , N1);
% æ—¶åŸŸåŒ¹é…æ»¤æ³¢
figure,plot( t1*1e6 , abs(s1) ),xlabel('t /us'),ylabel('å¹…åº¦è°±'),title('æ—¶é—´åè¤¶å–å…±è½­ï¼Œæ—¶åŸŸå·ç§¯');
```

![åŒ¹é…æ»¤æ³¢å™¨](https://i.loli.net/2020/12/01/AEhgyXCQ9G27uTb.jpg)

```matlab
%%è„‰å†²å‹ç¼© 
clear; 
close all; 

T=10e-6; %æ—¶å®½
B=30e6; %å¸¦å®½
Rmin=8500;
Rmax=11500;
R=[9000,10000,10200];
RCS=[1 1 1];
C=3e8;
K=B/T;
Rwid=Rmax-Rmin;
Twid=2*Rwid/C;
Fs=5*B;Ts=1/Fs;
Nwid=ceil(Twid/Ts);
t=linspace(2*Rmin/C,2*Rmax/C,Nwid); 
M=length(R);
td=ones(M,1)*t-2*R'/C*ones(1,Nwid); 
SNR=[1,0.001];

for i=1:1:2
   Srt1=RCS*(exp(1i*pi*K*td.^2).*(abs(td)<T/2));
   n=sqrt(0.5*SNR(i))*(randn(size(Srt1))+1i*randn(size(Srt1))); %åŠ å™ªå£°
   Srt=Srt1+n;
   Nchirp=ceil(T/Ts);
   Nfft=2^nextpow2(Nwid+Nwid-1);
   Srw=fft(Srt,Nfft);
   rw1=fft(Srt1,Nfft);
   t0=linspace(-T/2,T/2,Nchirp);
   St=exp(1i*pi*K*t0.^2);
   Sw=fft(St,Nfft);
   Sot=fftshift(ifft(Srw.*conj(Sw)));
   N0=Nfft/2-Nchirp/2;
   Z=abs(Sot(N0:N0+Nwid-1));
   figure
   subplot(211)
   plot(t*1e6,real(Srt));
   axis tight;
   xlabel('us');
   ylabel('å¹…åº¦')
   title(['åŠ å™ªçº¿æ€§è°ƒé¢‘ä¿¡å·å‹ç¼©å‰,SNR =',num2str(-1*10*log10(SNR(i)))]); 
   subplot(212)
   plot(t*C/2,Z)
   xlabel('Range in meters');ylabel('å¹…åº¦ ')
   title(['åŠ å™ªçº¿æ€§è°ƒé¢‘ä¿¡å·å‹ç¼©å,SNR =',num2str(-1*10*log10(SNR(i)))]); 
end
```

![LTM1](https://i.loli.net/2020/12/01/yLpGHR9DeitPQX5.jpg)

![LTM2](https://i.loli.net/2020/12/01/1GAEFXsN2RdTnU5.jpg)

æœ€åè¿™ä¸ªå®éªŒåˆ°åº•æ˜¯ä»€ä¹ˆé¬¼å•ŠğŸ˜¥