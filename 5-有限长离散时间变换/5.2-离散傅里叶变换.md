---
title: ç¦»æ•£å‚…é‡Œå¶å˜æ¢
---

<!--more-->
$$
\begin{align*}
\newcommand{\dif}{\mathop{}\!\mathrm{d}}
\newcommand{\belowarrow}[1]{\mathop{#1}\limits_{\uparrow}}
\newcommand{\bd}{\boldsymbol}
\newcommand{\L}{\mathscr{L}}
\newcommand{\xleftrightarrow}[1]{\stackrel{#1}{\longleftrightarrow}}
\end{align*}
$$

> é—²è°ˆï¼šæŒ‰é“ç†æ¥è¯´ï¼Œç¦»æ•£å‚…é‡Œå¶å˜æ¢åªæ¶‰åŠæœ‰é™ç‚¹è¿ç®—ï¼Œåº”è¯¥æ¯”æ— é™ç‚¹çš„ DTFT å¥½å­¦ï¼Œä½†å­¦èµ·æ¥å´æ™•å¾—ä¸è¡ŒğŸ˜µ ç©¶å…¶åŸå› ï¼Œæˆ‘åœ¨å­¦ä¹ æ—¶æ˜¯ä» DTFT å…¥æ‰‹çš„ï¼Œé‡åˆ°ä¸€äº›ä¸åŒä¹‹å¤„è€æ˜¯è½¬ä¸è¿‡æ¥ã€‚
>
> æ‰€ä»¥ï¼Œæˆ‘åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€ä»½å¾ˆè¯¦ç»†çš„è‹±è¯­èµ„æ–™ï¼Œä»å¦ä¸€ä¸ªæ–¹å‘å­¦ä¹  DFTã€‚ä¸‹é¢æˆ‘å°±å†™å†™æˆ‘å­¦ä¹ è¿‡ç¨‹ä¸­çš„ç¬”è®°ã€‚

# DFT æ¦‚è¿°

å¯¹äºé•¿åº¦ä¸º $N$ çš„åºåˆ— $x[n]$ï¼Œå…¶ç¦»æ•£å‚…é‡Œå¶å˜æ¢ DFT å®šä¹‰ä¸ºï¼š

$$
X[k] \triangleq \sum_{n=0}^{N-1} x[n] e^{-j\omega_k n} = \sum_{n=0}^{N-1} x[n] e^{-j 2\pi k n/N}
$$

# DFT çš„å¼•å…¥

## ä»å‡ ä½•å¼•å…¥ DFT

&emsp;&emsp;æˆ‘ä»¬å¯ä»¥å°†é•¿åº¦ä¸º $N$ çš„ä¿¡å·çœ‹åšä¸€ä¸ª $N$ ç»´å‘é‡ $x=[x_0,x_1,\cdots,x_{N-1}]$ï¼Œæ¯ä¸€ä¸ª $n$ å¯¹åº”ä¸€ä¸ªç»´åº¦ã€‚

&emsp;&emsp;æˆ‘ä»¬å¯ä»¥å®šä¹‰å‘é‡çš„å†…ç§¯ï¼š

$$
\langle u,v\rangle \triangleq \sum_{n=0}^{N-1} u[n] v^*[n]
$$

&emsp;&emsp;æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“å¾—å‡ºå‘é‡å†…ç§¯çš„å‡ ä¸ªæ€§è´¨ï¼š

* $\langle u,u\rangle=\mathcal{E}_u$ ï¼ˆèƒ½é‡ï¼‰
* å…±è½­å¯¹ç§°æ€§ï¼š$\langle u,v\rangle =\langle v,u\rangle ^*$
* çº¿æ€§æ€§ï¼š
  * $\langle \alpha u+\beta v,w\rangle = \alpha\langle u,w \rangle +\beta\langle v,w \rangle$
  * $\langle u,\alpha v+\beta w \rangle = \alpha\langle u,v \rangle +\beta\langle u,w \rangle$

&emsp;&emsp;æˆ‘ä»¬å¯ä»¥ç”¨å†…ç§¯å®šä¹‰å‘é‡çš„èŒƒæ•°ï¼š

$$
\|u\| \triangleq \sqrt{\langle u,u\rangle}=\sqrt{\sum_{n=0}^{N-1} u[n]u^*[n]}
$$

&emsp;&emsp;æœ‰äº†å†…ç§¯å’ŒèŒƒæ•°ï¼Œå°±å¯ä»¥å¾—åˆ°å‘é‡çš„æŠ•å½±ï¼š

$$
P_x(y) \triangleq \frac{\langle y,x\rangle}{\|x\|^2} x
$$

&emsp;&emsp;ä¸Šå¼è¡¨ç¤ºå‘é‡ $y$ åœ¨ $x$ ä¸Šçš„æŠ•å½±ã€‚æœ‰äº†æŠ•å½±ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¿¡å·çš„æ­£äº¤åˆ†è§£ï¼š

$$
x = \sum_{n=0}^{N-1} \alpha_n s_n\\
\alpha_n = P_{s_n}(x)
$$

&emsp;&emsp;å…¶ä¸­ï¼Œ$\{s_n\}$ æ˜¯ä¸€ç»„æ­£äº¤åŸºï¼Œæ»¡è¶³ï¼š

$$
P_{s_k}(s_l) \triangleq \frac{\langle s_l, s_k \rangle}{\|s_k\|^2} s_k =
\begin{cases}
0, & l\neq k\\
s_k, & l = k
\end{cases}
$$

&emsp;&emsp;æˆ‘ä»¬éƒ½çŸ¥é“ä¸åŒé¢‘ç‡çš„æ­£å¼¦ä¿¡å·åœ¨ä¸€ä¸ª**å‘¨æœŸ**å†…ç›¸äº’æ­£äº¤ï¼ˆå¦‚æœæ—¶é•¿ä¸æ˜¯æ•´å‘¨æœŸï¼Œåˆ™ä¸æ­£äº¤ï¼‰ï¼Œæ¯”å¦‚ï¼š

$$
x_1[n]=A_1 \sin( \frac{2\pi k_1}{N} n)\\
x_2[n]=A_2 \sin( \frac{2\pi k_2}{N} n)\\
k_1,k_2 \in \mathbb{Z}\,ä¸”\,0\leq k_1,k_2\lt N\\
$$

$$
\begin{align}
\langle x_1,x_2 \rangle &= \sum_{n=0}^{N-1} x_1x_2\\
&=A_1A_2 \sum_{n=0}^{N-1} \sin( \frac{2\pi k_1}{N} n) \sin( \frac{2\pi k_2}{N} n)\\
&=\frac{A_1A_2}{2} \sum_{n=0}^{N-1} \left[ \cos\left(\frac{2\pi k_1}{N} n-\frac{2\pi k_2}{N} n\right)-\cos\left(\frac{2\pi k_1}{N} n+\frac{2\pi k_2}{N} n\right) \right]\\
&=\frac{A_1A_2}{2} \sum_{n=0}^{N-1} \left\{ \cos\left[\frac{2\pi}{N}(k_1-k_2) n\right]-\cos\left[\frac{2\pi}{N} (k_1+k_2)n\right] \right\}\\
&=
\begin{cases}
0, & k_1\neq k_2\\
\frac{A_1A_2N}{2}, & k_1=k_2
\end{cases}
\end{align}
$$

&emsp;&emsp;å¦‚æœæˆ‘ä»¬ä»¥ $f_s$ å¯¹ $x(t)$ é‡‡æ ·å¾—åˆ° $N$ ç‚¹ $x[n]$ï¼Œæ ¹æ®ä¸Šé¢çš„è¯æ˜ï¼Œæˆ‘ä»¬èƒ½å–çš„è°æ³¢é¢‘ç‡åªèƒ½æ˜¯ï¼š

$$
f_k = \frac{k}{N} f_s, \; k=0,1,2,\cdots,N-1
$$

&emsp;&emsp;äºæ˜¯æˆ‘ä»¬æ„é€ å¦‚ä¸‹ä¸€ç»„æ­£äº¤åŸºï¼ˆä»æ­£å¼¦æ¨å¹¿åˆ°eæŒ‡æ•°ï¼‰ï¼š

$$
s_k[n]\triangleq e^{j \omega_k nT}=e^{j 2\pi kn/N}\\
\omega_k \triangleq 2\pi f_k= 2\pi k\frac{f_s}{N}ï¼ŒT=\frac{1}{f_s}
$$

&emsp;&emsp;ä¸ºäº†å·æ‡’ï¼Œæˆ‘ä»¬å®šä¹‰ $W_N=e^{-j2\pi/N}$ï¼Œå› æ­¤ $s_k=W_N^{-k}$ã€‚æœ‰è¶£çš„æ˜¯ï¼Œè¿™ä¸€ç»„æ­£äº¤åŸºæ­£å¥½å‡åˆ†å¤å¹³é¢ä¸Šçš„å•ä½åœ†ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ã€‚

<!--![DFT_WN](/assets/images/DFT_WN.png)-->

<center><img src="https://i.loli.net/2020/10/19/4vFCJINQbS31Ppz.png" width="500"></center>

&emsp;&emsp;æˆ‘ä»¬å¯ä»¥è¯æ˜è¿™æ˜¯ä¸€ç»„æ­£äº¤åŸºï¼š

$$
\begin{align}
\langle s_k,s_l \rangle &\triangleq \sum_{n=0}^{N-1} s_k[n] s_l^*[n]\\
&=\sum_{n=0}^{N-1} e^{j2\pi (k-l) n/N}\\
&=\frac{1-e^{j2\pi(k-l)}}{1-e^{j2\pi(k-l)/N}}\\
&=
\begin{cases}
0 & k\neq l\\
N & k=l
\end{cases}
\end{align}
$$

&emsp;&emsp;æˆ‘ä»¬è¿›ä¸€æ­¥å¯¹ $s_k$ è¿›è¡Œæ­£åˆ™åŒ–ï¼š

$$
\tilde{s}_k[n] \triangleq \frac{s_k[n]}{\sqrt{N}}\\
\langle \tilde{s}_k,\tilde{s}_l \rangle =
\begin{cases}
0 & k\neq l\\
1 & k=l
\end{cases}
$$

&emsp;&emsp;ä¿¡å·åœ¨ $\tilde{s}_k$ ä¸Šçš„æŠ•å½±å°±æ˜¯ NDFTï¼ˆNormalized DFTï¼‰ï¼Œä¿¡å·åœ¨ $s_k$ ä¸Šçš„æŠ•å½±çš„ $N$ å€å°±æ˜¯ DFTï¼š

$$
X[k] \triangleq \langle x,s_k \rangle \triangleq \sum_{n=0}^{N-1} x[n] s_k^*[n] \quad k=0,1,\cdots,N-1\\
å…¶ä¸­ï¼Œs_k[n] \triangleq e^{j 2\pi kn/N}
$$

&emsp;&emsp; $x$ åœ¨ $s_k$ ä¸Šçš„æŠ•å½±ä¸ºï¼š

$$
\frac{\langle x,s_k\rangle}{\|s_k\|^2}=\frac{X[k]}{N}
$$

&emsp;&emsp;è¦ä»æŠ•å½±æ¢å¤å›åŸä¿¡å·ï¼Œæˆ‘ä»¬åªéœ€è¦å°†åˆ†è§£åçš„å‘é‡ç›¸åŠ ï¼Œæ³¨æ„åˆ°DFTå®é™…æ˜¯æŠ•å½±çš„ $N$ å€ï¼Œæ‰€ä»¥è¿˜éœ€è¦é™¤ä»¥ $N$ï¼š

$$
x[n]=\frac{1}{N}\sum_{k=0}^{N-1} X[k] e^{j 2\pi kn/N}
$$

## ä»æŠ½æ ·å¼•å…¥ DFT

&emsp;&emsp;å›å¿†æˆ‘ä»¬å¯¹æ¨¡æ‹Ÿä¿¡å·è¿›è¡Œé‡‡æ ·çš„è¿‡ç¨‹ï¼Œç»è¿‡é‡‡æ ·åï¼Œé¢‘åŸŸè¿›è¡Œäº†å‘¨æœŸæ€§å»¶æ‹“ã€‚åŒç†ï¼Œå¦‚æœæˆ‘ä»¬å¯¹é¢‘åŸŸè¿›è¡Œé‡‡æ ·ï¼Œé‚£ä¹ˆæ—¶åŸŸä¹Ÿè¿›è¡Œå‘¨æœŸæ€§å»¶æ‹“ï¼Œè¯æ˜å¦‚ä¸‹ï¼šæˆ‘ä»¬å…ˆæ±‚è§£ $\delta[n-kN]$ çš„ç¦»æ•£æ—¶é—´å‚…é‡Œå¶å˜æ¢ï¼š

$$
\begin{align}
a_k &= \frac{1}{N}\sum_{n=\langle N \rangle} \delta[n-kN] e^{-jk\omega_0n} \\
&= \frac{1}{N} \sum_{n=0}^{N-1} \delta[n-kN] e^{-jk\omega_0n}\\
&= \frac{1}{N} \\
\end{align}\\
$$

$$
\begin{align}
X(e^{j\omega}) &=\sum_{k=-\infty}^{+\infty} 2\pi a_k \delta(\omega-\frac{2\pi k}{N})\\
&= \frac{2\pi}{N} \sum_{k=-\infty}^{+\infty}  \delta(\omega-\frac{2\pi k}{N})
\end{align}
$$

&emsp;&emsp;ç”±äºæ—¶åŸŸå·ç§¯å¯¹åº”é¢‘åŸŸç›¸ä¹˜ï¼Œæ•…å¦‚æœåœ¨é¢‘åŸŸä¸Š $[0,2\pi]$ å†…å– $N$ ç‚¹ï¼Œåˆ™æ—¶åŸŸä¸Šä¼šä»¥ $N$ ä¸ºå‘¨æœŸã€‚ç»“åˆç¦»æ•£æ—¶é—´å‚…é‡Œå¶å˜æ¢ï¼ˆDTFTï¼‰ï¼š

$$
åˆ†æå…¬å¼ï¼šX(e^{j\omega})=\sum_{n=-\infty}^{+\infty} x[n] e^{-j\omega n}\\
ç»¼åˆå…¬å¼ï¼šx[n]=\frac{1}{2\pi} \int_{2\pi} X(e^{j\omega}) e^{j\omega n} \dif \omega
$$

&emsp;&emsp;æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDFTï¼‰ï¼š

$$
X[k] \triangleq \sum_{n=0}^{N-1} x[n] e^{-j \frac{2\pi k}{N} n}\\
x[n]=\frac{1}{N}\sum_{k=0}^{N-1} X[k] e^{j \frac{2\pi k}{N} n}
$$

&emsp;&emsp;æŠŠ $\omega$ æ›¿æ¢æˆ $\frac{2\pi k}{N}$ çš„è¿‡ç¨‹å°±ç›¸å½“äºåœ¨é¢‘åŸŸå–æ ·ã€‚ä¸ºäº†å·æ‡’ï¼Œæˆ‘ä»¬å®šä¹‰ $W_N=e^{-j2\pi/N}$ï¼Œå¹¶æ”¹å†™ä¸ºï¼š

$$
X[k] \triangleq \sum_{n=0}^{N-1} x[n] W_N^{kn}\\
x[n]=\frac{1}{N}\sum_{k=0}^{N-1} X[k] W_N^{-kn}
$$

&emsp;&emsp;ä» $X[k]$ æ¢å¤æˆ $X(e^{j\omega})$ åˆ™æ˜¯é€šè¿‡æ’å€¼æ¥å®ç°ï¼š

$$
\begin{align}
X(e^{j\omega}) &= \sum_{n=0}^{N-1} \left\{ \frac{1}{N}\sum_{k=0}^{N-1} X[k] W_N^{-kn} \right\} e^{-j\omega n}\\
&= \frac{1}{N} \sum_{k=0}^{N-1} X[k] \sum_{n=0}^{N-1} e^{j \frac{2\pi k}{N} n} e^{-j\omega n}\\
\end{align}
$$

$$
\begin{align}
\sum_{n=0}^{N-1} e^{j \frac{2\pi k}{N} n} e^{-j\omega n} &= \frac{1-e^{-j(\omega N - 2\pi k)}}{1-e^{-j(\omega - 2\pi k/N)}}\\
&= \frac{e^{-j[(\omega N - 2\pi k)/2]}}{e^{-j[(\omega N - 2\pi k)/2N]}} \frac{\sin \left( \frac{\omega N-2 \pi k}{2} \right)}{\sin \left( \frac{\omega N-2 \pi k}{2N} \right)}\\
&= \frac{\sin \left( \frac{\omega N-2 \pi k}{2} \right)}{\sin \left( \frac{\omega N-2 \pi k}{2N} \right)} e^{-j[\omega - (2\pi k/N)][(N-1)/2]}
\end{align}
$$

æˆ‘ä»¬å®šä¹‰æ’å€¼å‡½æ•°ä¸º $\Phi (\omega)$ï¼š

$$
\begin{align}
\Phi(\omega) &= \frac{\sin \left( \frac{\omega N}{2} \right)}{N \sin \left( \frac{\omega}{2} \right)} e^{-j\omega [(N-1)/2]}
\end{align}\\
ç‰¹æ®Šçš„ï¼Œ\Phi(\omega)\Big|_{\omega=2\pi k/N} = 
\begin{cases}
1, & k=0\\
0, & 1\leq k \leq N-1
\end{cases}
$$

<!--![DFTæ’å€¼å‡½æ•°](/assets/images/DFTæ’å€¼å‡½æ•°.jpg)-->

<center><img src="https://i.loli.net/2020/10/25/TR1k4BUoDdtK73i.jpg" width=500 title="N=5æ—¶çš„æ’å€¼å‡½æ•°ï¼ˆå·¦ï¼šå¹…åº¦+ç›¸ä½ï¼Œå³ï¼šç›¸ä½ï¼‰"></center>

åˆ™æ’å€¼è¿‡ç¨‹èƒ½è¡¨ç¤ºæˆï¼š

$$
X(e^{j\omega}) = \sum_{k=0}^{N-1} X[k] \Phi\left( \omega - \frac{2\pi k}{N} \right)
$$

# é¢‘è°±æ³„éœ²

&emsp;&emsp;ä»é‡‡æ ·çš„è§’åº¦å»ç†è§£çš„è¯ï¼Œå¯¹äºé‚£äº›ä»‹äºé‡‡æ ·ç‚¹ä¹‹é—´çš„é¢‘ç‡ï¼Œä»ç›´è§‰ä¸Šæ¥è®²æ˜¯æ— æ³•å¾—åˆ°çš„ï¼Œä½†å¹¶éå¦‚æ­¤ã€‚

&emsp;&emsp;æˆ‘ä»¬å¯ä»¥å‡è®¾ä»»æ„ä¸€ä¸ªæ­£å¼¦ä¿¡å·ï¼š$x[n]=e^{j\omega_x nT}$ï¼Œå°†å®ƒä¸æ­£äº¤åŸºåšå†…ç§¯ï¼š

$$
\begin{align}
X(\omega_k) &= \langle x,s_k^* \rangle\\
&= \sum_0^{N-1} e^{j\omega_x nT} e^{-j\omega_k nT}\\
&= \sum_0^{N-1} e^{j(\omega_x-\omega_k) nT}\\
&= \frac{1-e^{j(\omega_x-\omega_k) NT}}{1-e^{j(\omega_x-\omega_k) T}}\\
&= e^{j(\omega_x-\omega_k)(N-1)T/2} \frac{\sin[(\omega_x-\omega_k)NT/2]}{\sin[(\omega_x-\omega_k)T/2]}
\end{align}
$$

&emsp;&emsp;æ˜¾ç„¶ï¼Œå½“ $\omega_x=\omega_k$ æ—¶ï¼Œ$X(\omega_k)=N$ï¼›è€Œå½“ $\omega_x\neq\omega_k$ æ—¶ï¼Œæœ‰ï¼š

$$
|X(\omega_k)|=\left|\frac{\sin[(\omega_x-\omega_k)NT/2]}{\sin[(\omega_x-\omega_k)T/2]}\right|
$$

&emsp;&emsp;æˆ‘ä»¬ä¹‹å‰å®šä¹‰è¿‡ï¼š

$$
\omega_k \triangleq 2\pi k\frac{f_s}{N}= 2\pi k\frac{1}{TN},\;k=0,1,\cdots,N-1
$$

æˆ‘ä»¬ä¸å¦¨å– $N=16$ï¼Œ$x=N/5$ï¼ˆä¹Ÿå°±æ˜¯ $\omega_x = 2 \pi \frac{N}{5} \frac{f_s}{N}$ï¼‰ï¼Œä½œå‡ºå›¾åƒï¼š

<center><img src="https://i.loli.net/2020/11/02/vS689hWQg14dPIM.jpg" width=500 title="DFTé¢‘è°±æ³„éœ²"></center>

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ€é è¿‘ $N/5$ çš„è°±çº¿ï¼Œä¹Ÿå°±æ˜¯ $k=N/4=4$ çš„è°±çº¿æ˜¯æœ€é«˜çš„ï¼Œå¦å¤–ï¼Œå…¶ä»–è°±çº¿ä¹Ÿæœ‰ä¸€å®šçš„å€¼ã€‚è¿™å°±å« **é¢‘è°±æ³„éœ²**ã€‚

&emsp;&emsp;ä¸Šé¢æ˜¯é€šè¿‡å…¬å¼æ¨å¯¼å¾—åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ matlab æ¥è¿›è¡ŒéªŒè¯ï¼Œæœ€ç»ˆç”»å‡ºæ¥çš„å›¾åƒæ˜¯ä¸€æ ·çš„ã€‚

```matlab
fs=1;
N=16;
x=N/5;
wx=2*pi*x*fs;
n=[0:N-1];
xn=exp(j*wx*n);
wn=2*pi*n/N;
stem(wn,abs(fft(xn)));
```

# å¸¸è§ DFT å˜æ¢å¯¹

$$
\sum_{k=-\infty}^\infty \delta[n+Nk] = \left\{ \begin{array}{ll} 1, & \text{ if } n=0, \pm N, \pm 2N , \ldots\\ 0, & \text{ else.} \end{array}\right.\\
\xleftrightarrow{DFT} 1 \;(\text{period} N)
$$

$$
e^{j2\pi k_0 n/N} \xleftrightarrow{DFT} N\delta[\langle k - k_0\rangle_N]
$$

$$
\cos(\frac{2\pi}{N}k_0n) \xleftrightarrow{DFT} \frac{N}{2}(\delta[\langle k - k_0\rangle_N] + \delta[\langle k - k_0\rangle_N])
$$

# DFT çš„æ€§è´¨

## çº¿æ€§æ€§

$$
\alpha g[n] + \beta h[n] \xleftrightarrow{\text{DFT}} \alpha G[k] + \beta H[k]
$$

è¿™ä¸ªæ²¡å•¥å¥½è¯´çš„ï¼Œè¯æ˜æ–¹æ³•å’Œä¹‹å‰å‚…é‡Œå¶å˜æ¢ä¸€æ ·ã€‚

## åœ†å‘¨æ—¶ç§»

&emsp;&emsp;ç”±äº DFT æœ¬è´¨ä¸Šæ˜¯å¯¹åŸä¿¡å·åœ¨æ—¶åŸŸä¸Šè¿›è¡Œå‘¨æœŸå»¶æ‹“ï¼Œé‚£ä¹ˆå½“ä¿¡å·è¿›è¡Œæ—¶ç§»å˜æ¢æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨è¿›è¡Œâ€œåœ†å‘¨å¹³ç§»â€ã€‚

$$
g[\langle n-n_0 \rangle_N] \xleftrightarrow{\text{DFT}} W_N^{kn_0} G[k]
$$

&emsp;&emsp;å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç®€å•è¯æ˜ä¸€ä¸‹ï¼š

$$
\begin{align}
\sum_{n=0}^{N-1} x[\langle n-n_0 \rangle_N] W_N^{kn} &= \sum_{n=0}^{N-1} x[\langle n-n_0 \rangle_N] W_N^{k(n-n_0+n_0)}\\
&= W_N^{kn_0} \sum_{n=0}^{N-1} x[\langle n-n_0 \rangle_N] W_N^{k(n-n_0)}\\
&= W_N^{kn_0} X[k]
\end{align}
$$

## åœ†å‘¨é¢‘ç§»

&emsp;&emsp;è€ƒè™‘åˆ°é¢‘è°±åŸæœ¬ä¹Ÿæ˜¯å‘¨æœŸçš„ï¼Œå½“é¢‘è°±å¹³ç§»æ—¶ï¼Œå®é™…ä¸Šæ—¶è¿›è¡Œåœ†å‘¨å¹³ç§»ã€‚
$$
W_N^{-k_0 n} g[n] \xleftrightarrow{\text{DFT}} G[\langle k-k_0 \rangle_N]
$$


## å¯¹ç§°æ€§

|åºåˆ—|DFT|
|---|---|
|$x[n]=x_\text{re}[n]+j x_\text{im}[n]$|$X[k]=X_\text{re}[k]+j X_\text{im}[k]$|
|$x^*[n]$|$X^*[\langle-k\rangle_N]$|
|$x^*[\langle-n\rangle_N]$|$X^*[k]$|
|$x_\text{re}[n]$|$X_\text{cs} =\frac{1}{2} \{ X[k]+X^*[\langle -k \rangle_N] \}$|
|$j x_\text{im}[n]$|$X_\text{ca}[k]=\frac{1}{2} \{ X[k]-X^*[\langle -k \rangle_N] \}$|
|$x_\text{cs}[n]$|$X_\text{re}[k]$|
|$x_\text{ca}[n]$|$jX_\text{im}[k]$|

ä¹ä¸€çœ‹å¥½åƒå¾ˆå¤æ‚ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹çœ‹ç¬¬ 2 æ¡å¼å­çš„è¯æ˜ğŸ‘€ï¼š

$$
\begin{aligned}
\sum_{n=0}^{N-1} x^*[n] e^{-\frac{2\pi kn}{N}} &= \left\{ \sum_{n=0}^{N-1}  x[n] e^{2\pi kn/N} \right\}^*\\
&= \left\{ \sum_{n=0}^{N-1}  x[n] e^{-2\pi (-k)n/N} \right\}^*\\
&= \left\{ \sum_{n=0}^{N-1}  x[n] e^{-2\pi \langle -k\rangle_N n/N} \right\}^*\\
&= X^*[\langle-k\rangle_N]   
\end{aligned}
$$

ç¬¬ 3 æ¡ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚ç„¶åç”± 2ã€3 å°±èƒ½æ¨å¯¼å‡ºåé¢çš„ã€‚

å¯¹ç§°æ€§å¯ä»¥ç”¨äºç®€åŒ–æŸäº›ç‰¹æ®Šçš„ DFT è®¡ç®—ï¼Œè€ƒè¯•ä¸­æ¯”è¾ƒå–œæ¬¢è€ƒçš„å°±æ˜¯ï¼šæœ‰ä¸€ä¸ª $2N$ é•¿çš„å®åºåˆ—ï¼Œè¦æ±‚ç”¨ $N$ é•¿çš„ FFT è¿›è¡Œè®¡ç®—ï¼ˆå¯ä»¥ç”¨å…¶ä»–ç®€å•çš„è¾…åŠ©è¿ç®—ï¼‰ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š

## åœ†å‘¨å·ç§¯å®šç†

$$
g[n] â“ƒ h[n] \xleftrightarrow{DFT} G[k]H[k]
$$

ç›´æ¥è¯æ˜å¤ªéº»çƒ¦äº†ï¼Œå¯ä»¥ä» DTFT çš„å·ç§¯æ€§è´¨æ¨å¯¼ï¼Œç„¶åå†é‡‡æ ·å°±è¡Œã€‚æ€»è€Œè¨€ä¹‹ï¼Œå‡¡æ˜¯çœ‹åˆ°â€œåœ†å‘¨â€ï¼Œå°±è¦æƒ³åˆ°å¯¹å‘¨æœŸä¿¡å·è¿›è¡Œé‡‡æ ·ã€‚

## è°ƒåˆ¶å®šç†

$$
g[n]h[n] \xleftrightarrow{DFT}  \frac{1}{N} \sum_{\ell=0}^N G[\ell]H[\langle k-\ell \rangle_N]
$$

ä¸Šä¸€æ¡å®šç†çš„å¯¹å¶å®šç†ã€‚

## å¯¹å¶å®šç†

$$
g[n] \xleftrightarrow{DFT} G[k]\\
G[n] \xleftrightarrow{DFT} N g[\langle -k \rangle_N]
$$

è¿™ä¸ªè¯èµ·æ¥ä¸éš¾ï¼Œæˆ‘å°±è¯´ä¸ªå¤§æ¦‚å§ï¼ˆ~~å…¶å®æ˜¯æƒ³å·æ‡’~~ï¼‰

* å¯¹ $G[n]$ è¿›è¡Œ DFT
* å…ˆä»£å…¥ $g[n]$
* å†äº¤æ¢æ±‚å’Œé¡ºåº
* å˜é‡ä»£æ¢ï¼ˆå¼•å…¥äº†åœ†å‘¨æ—¶åï¼‰
* åŒ–ç®€ï¼ŒåŒ–ç®€æ—¶ä¼šç”¨åˆ°ä¸€æ¡å…³ç³»å¼ï¼ˆå¼•å…¥äº† $N$ï¼‰ï¼š

$$
\sum_{n=0}^{N-1} W_N^{kn} = 
\begin{cases}
  N, & k=0\\
  0, & k\neq 0
\end{cases}
$$


{{% details "æ‡’å¾—è‡ªå·±ç®—çš„åŒå­¦è¯·ç‚¹å‡»å±•å¼€" %}}
$$
\begin{aligned}
  \sum_{n=0}^{N-1} G[n] W_N^{kn} &= \sum_{n=0}^{N-1} \left\{ \sum_{m=0}^{N-1} g[m] W_N^{nm} \right\} W_N^{kn}\\
  &= \sum_{m=0}^{N-1} \left\{ \sum_{n=0}^{N-1} g[m] W_N^{n(m+k)} \right\}\\
  {}^{(\ell=m+k)}&= \sum_{\ell=0}^{N-1} \left\{ \sum_{n=0}^{N-1} g[\langle \ell - k \rangle_N] W_N^{n\ell } \right\}\\
  &=N [\langle- k \rangle_N]
\end{aligned}
$$
<hr>
{{% /details %}}

## Parseval å®šç†

$$
\sum_{n=0}^{N-1} g[n]h^*[n]=\frac{1}{N} \sum_{k=0}^{N-1} G[k]H^*[k]\\
ç‰¹æ®Šçš„ï¼Œ\sum_{n=0}^{N-1} |g[n]|^2 =\frac{1}{N} \sum_{k=0}^{N-1} |G[k]|^2
$$

è¯æ˜æ–¹æ³•å˜›ï¼Œå…ˆå°† $h[n]$ ç”¨ $H[k]$ è¡¨ç¤ºï¼ˆè¿™ä¸€æ­¥å¼•å…¥äº† $1/N$ï¼‰ï¼Œç„¶ååˆ©ç”¨å…±è½­ä½¿å¾— $W_{N}^{-kn}$ å˜ä¸º $W_{N}^{kn}$ï¼Œç„¶åäº¤æ¢æ±‚å’Œé¡ºåºï¼Œå†æŠŠ $g[n]$ å˜æˆ $G[k]$ã€‚

# ä¹ é¢˜

> [!TIP]
> 5.8 æ±‚é•¿åº¦ä¸º $N$ çš„å¦‚ä¸‹åºåˆ—çš„ $N$ ç‚¹ DFTï¼š<br>
> ï¼ˆaï¼‰$x_a[n]=\cos (2 \pi n /N)$<br>
> ï¼ˆbï¼‰$x_b[n]=\sin^2(2 \pi n/N)$<br>
> ï¼ˆcï¼‰$x_c[n]=\sin^3 (2 \pi n/N)$

> [!NOTE]
> è§£ï¼šç”±äºæ˜¯ä¸‰è§’å‡½æ•°ï¼Œæ‰€ä»¥é¦–å…ˆæƒ³åˆ°çš„æ˜¯å†™æˆ $e$ æŒ‡æ•°çš„å½¢å¼å†æ±‚è§£ã€‚<br>
> 
> $$
\begin{aligned}
x_a[n]&=\frac{1}{2}\left( e^{j2 \pi n /N}+e^{-j2 \pi n /N} \right)\\
x_b[n]&=\frac{1-\cos(2 \pi 2n /N)}{2}=\frac{1-\frac{1}{2}\left( e^{j2 \pi 2n /N}+e^{-j2 \pi 2n /N} \right)}{2}\\
x_c[n]&=\frac{1}{4}[3 \sin(2 \pi n/N)-\sin (2 \pi 3n/N)]\\
&=\frac{1}{4}\left[ \frac{3}{2j}\left( e^{j2 \pi n /N}-e^{-j2 \pi n /N} \right) - \frac{1}{2j}\left( e^{j2 \pi 3n /N}-e^{-j2 \pi 3n /N} \right) \right]
\end{aligned}
$$

æ ¹æ®å¸¸ç”¨ DFT å˜æ¢å¯¹ $e^{j2\pi k_0 n/N}\xleftrightarrow{DFT}N\delta(\langle k - k_0\rangle_N)$ï¼Œå¯ä»¥ç›´æ¥å†™å‡ºï¼š<br>

$$
\begin{aligned}
X_a[k]&=\frac{N}{2} \left[\delta(\langle k - 1\rangle_N)+\delta(\langle k + 1\rangle_N)\right]\\
X_b[k]&=\frac{1-\frac{N}{2} \left[\delta(\langle k - 2\rangle_N)+\delta(\langle k + 2\rangle_N)\right]}{2}\\
x_c[k]&=\frac{1}{4}\left[ \frac{3}{2j}\Big( \delta(\langle k - 1\rangle_N)-\delta(\langle k + 1\rangle_N)\Big)\\- \frac{1}{2j}\Big( \delta(\langle k - 3\rangle_N)-\delta(\langle k + 3\rangle_N)\Big) \right]
\end{aligned}
$$

<br>

> [!TIP]
> 5.14 è®¾ $X[k]$ æ˜¯é•¿ä¸º $N$ çš„åºåˆ— $x[n]$ çš„ $N$ ç‚¹ DFTï¼Œ$N$ ä¸ºå¶æ•°ã€‚å®šä¹‰ä¸¤ä¸ªé•¿åº¦ä¸º $\frac{N}{2}$ çš„åºåˆ—ä¸ºï¼š<br>
> 
> $$
\displaylines{
g[n] = \frac{1}{2}(x[2n]+x[2n+1])\\
h[n] = \frac{1}{2}(x[2n]-x[2n+1])\\
0\leq n \leq \frac{N}{2}-1
}
$$<br>

è‹¥ $g[n]$,$h[n]$ çš„ $N/2$ ç‚¹ DFT åˆ†åˆ«æ˜¯ $G[n]$,$H[n]$ï¼Œè¯·ç”¨ $G[n],H[n]$ æ±‚ $X[n]$

[!NOTE]
è§£ï¼šè¿™é¢˜æ˜¾ç„¶æ˜¯è€ƒ <a href="/courses/junior/dsp/FFT">DIT-FFT</a>ï¼Œæ ¹æ® DIT-FFT çš„å…¬å¼ï¼Œå¯ä»¥å†™å‡ºï¼š<br>

$$
\begin{aligned}
X[k]&=\sum_{r=0}^{N/2-1} x[2r] (W_N^{2})^{kr}+W_N^{k} \sum_{r=0}^{N/2-1} x[2r+1] (W_N^{2})^{kr}\\
&=\sum_{r=0}^{N/2-1} x[2r] W_{N/2}^{kr}+W_N^{k} \sum_{r=0}^{N/2-1} x[2r+1] W_{N/2}^{kr}\\
&= (G[k]+H[k])+W_N^k (G[k]-H[k]) \quad k=0,1,\cdots,N-1
\end{aligned}
$$
> 
> $$
X[k+\frac{N}{2}] = (G[k]+H[k])-W_N^k (G[k]-H[k]) \quad k=0,1,\cdots,N-1
$$

<br>

[!TIP]
5.48 åºåˆ— $\{x[n]\}=\{2,-3,1,4\}$ï¼Œ$0\leq n \leq3$ï¼Œä¸ä¸‹é¢å®šä¹‰åœ¨ $0\leq n \leq3$ è¿›è¡Œ 4 ç‚¹åœ†å‘¨å·ç§¯ï¼š<br>

$$
\displaylines{
\{h_1[n]\}=\{1,4,-2,-3\}\\
\{h_2[n]\}=\{5,4-4,-1,3\}\\
\{h_3[n]\}=\{-2,5,2,-4\}\\
\{h_4[n]\}=\{-3,2,-3,4\}
}
$$
> 
> è®¡ç®—ç»“æœå¦‚ä¸‹ï¼š
> 
> $$
\displaylines{
\{y_a[n]\}=\{-16,-24,27,25\}\\
\{y_b[n]\}=\{-13,5,1,7\}\\
\{y_c[n]\}=\{30,20,-29,-17\}\\
\{y_d[n]\}=\{25,-6,-27,8\}\\
}
$$

ä¸è®¡ç®—åœ†å‘¨å·ç§¯ï¼Œå°†ç»“æœä¸åœ†å‘¨å·ç§¯é…å¯¹ã€‚

[!NOTE]
è§£ï¼šå¯ä»¥é€šè¿‡æ±‚ DFT æ¥æ±‚åœ†å‘¨å·ç§¯ï¼Œä¸è¿‡å¤ªéº»çƒ¦äº†ã€‚å¯ä»¥è¿›è¡Œæ±‚å’Œï¼š<br>

$$
\displaylines{
\sum_{n=0}^{N-1} x[n]=4\\
\sum_{n=0}^{N-1} h_1[n]=0 \quad \sum_{n=0}^{N-1} y_a[n]=12\\
\sum_{n=0}^{N-1} h_2[n]=3 \quad \sum_{n=0}^{N-1} y_b[n]=0\\
\sum_{n=0}^{N-1} h_3[n]=1 \quad \sum_{n=0}^{N-1} y_c[n]=4\\
\sum_{n=0}^{N-1} h_4[n]=0 \quad \sum_{n=0}^{N-1} y_d[n]=0
}
$$
> 
> ç”±äº $\sum x \cdot \sum h_2 = \sum y_a$ å’Œ $\sum x \cdot \sum h_3 = \sum y_c$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ¤æ–­å‡ºï¼š<br>
> 
> $$
x â“ƒ h_2 = y_a\\
x â“ƒ h_3 = y_c
$$

è¿˜æœ‰ä¿©ä¸ªåˆ¤æ–­ä¸äº†ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œäº¤æ›¿æ±‚å’Œï¼š<br>

$$
\displaylines{
\sum_{n=0}^{N-1} (-1)^n x[n]=2\\
\sum_{n=0}^{N-1} (-1)^n h_1[n]=-2
\quad \sum_{n=0}^{N-1} (-1)^n y_b[n]=-24    \\
\sum_{n=0}^{N-1} (-1)^n h_4[n]=-12 \quad \sum_{n=0}^{N-1} (-1)^n y_d[n]=-4
}
$$
> 
> ç”±äº $\sum (-1)^n x \cdot \sum (-1)^n h_1 = \sum (-1)^n y_d$ å’Œ $\sum (-1)^n x \cdot \sum (-1)^n h_4 = \sum (-1)^n y_b$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ¤æ–­å‡ºï¼š<br>
> 
> $$
x â“ƒ h_1 = y_d\\
x â“ƒ h_4 = y_b
$$

<br>

[!TIP]
5.51 å¶æ•°é•¿ $x[n]$ çš„ DFT ä¸º $X[k]$ï¼Œç”¨ $X[k]$ è¡¨ç¤ºä¸‹åˆ—åºåˆ—çš„ $N$ ç‚¹ DFT<br>

$$
\begin{aligned}
u[n]&=x[n]-x[\langle n-\frac{N}{2} \rangle_N]\\
v[n]&=x[n]+x[\langle n- \frac{N}{2}\rangle_N]\\
y[n]&=(-1)^n x[n]
\end{aligned}
$$

> [!NOTE]
> è§£ï¼šè€ƒå¯Ÿçš„æ˜¯ DFT çš„æ€§è´¨ã€‚<br> 
> 
> $$
U[k]=X[k]-(-1)^k X[k]\\
V[k]=X[k]+(-1)^k X[k]\\
Y[k]=X[\langle k- \frac{N}{2}\rangle_N]
$$