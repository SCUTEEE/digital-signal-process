---
title: FFT
---

<!--more-->

$$
\begin{align*}
\newcommand{\dif}{\mathop{}\!\mathrm{d}}
\newcommand{\belowarrow}[1]{\mathop{#1}\limits_{\uparrow}}
\newcommand{\bd}{\boldsymbol}
\newcommand{\L}{\mathscr{L}}
\newcommand{\red}{\color{red}}
\newcommand{\xleftrightarrow}[1]{\stackrel{#1}{\longleftrightarrow}}
\end{align*}
$$

è™½è¯´ DFT ä¸éœ€è¦åƒ DTFT é‚£æ ·ç®—æ— ç©·å¤šé¡¹äº†ï¼Œä½†è¦ç®—çš„ä¸œè¥¿ä¹Ÿæ˜¯æŒºå¤šçš„ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å¤æ‚åº¦ï¼š

$$
X[k]=\sum_{n=0}^{N-1}x[n]W_N^{kn},\;k=0,1,\cdots,N-1\\
W_N^{kn}=e^{-2\pi kn/N}
$$

è¦è®¡ç®—å‡º $N$ ä¸ª $X[k]$ï¼Œå¿…é¡»è¿›è¡Œ $N^2$ æ¬¡å¤æ•°ä¹˜æ³•å’Œ $N(N-1)$ æ¬¡å¤æ•°åŠ æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(N^2)$ã€‚

å‡å¦‚æœ‰ä¸€ä¸ª 44.1 kHz é‡‡æ ·ç‡çš„ 1s éŸ³é¢‘ï¼Œé‚£ä¹ˆä¹˜æ³•çš„è¿ç®—é‡å¤§çº¦æ˜¯ 1.94Gï¼Œè€Œç°åœ¨çš„è®¡ç®—æœºå¤„ç†é€Ÿåº¦ä¹Ÿå°± 3~5GHzï¼Œä¹Ÿå°±æ˜¯è¯´ 1s ä¹Ÿå°±ç®—ä¸ªå‡ æ¬¡ DFTï¼Œè¦æ˜¯æ¢ä»¥å‰çš„ CPUï¼Œä¼°è®¡å¾—ç®—ä¸€ä¸ªæ˜ŸæœŸğŸ˜“ã€‚

ä½†æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ DFT ä¸­ $W_N^{kn}$ çš„ä¸€äº›ç‰¹æ®Šæ€§è´¨æ¥ç®€åŒ–è®¡ç®—ã€‚æ¯”å¦‚è¯´ï¼š$W_N^{k+\frac{N}{2}}=-W_N^k$ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥å‡å°‘ä¸€åŠçš„è¿ç®—é‡ï¼Œä½†æ—¶é—´å¤æ‚åº¦è¿˜æ˜¯ $O(N^2)$ã€‚å¦‚æœç”¨ä¸Šå…¶ä»–æ€§è´¨ï¼Œå°±èƒ½åœ¨ $O(n\log n)$ æ—¶é—´å†…æ±‚å‡ºæ¥ï¼Œå°±å¾—åˆ°æˆ‘ä»¬çš„ FFT ç®—æ³•ã€‚

# åŸº-2 FFT

## DIT-FFT ç®—æ³•

æŒ‰æ—¶é—´æŠ½å– FFT ç®—æ³•ï¼ˆDIT-FFTï¼ŒDecimation In Time FFTï¼‰ï¼Œä¹Ÿå« Cooley-Tukey Fast Fourier Transformï¼Œæ˜¯ 1965 å¹´ç”± Cooley å’Œ Tukey æå‡ºï¼Œç°åœ¨ä½¿ç”¨çš„å¤§éƒ¨åˆ† FFT éƒ½æ˜¯åœ¨è¿™ä¸ªç®—æ³•çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›çš„ã€‚è¿™ä¸ªç®—æ³•çš„æ­¥éª¤å¦‚ä¸‹ï¼š

è®¾åºåˆ— $x[n]$ çš„é•¿åº¦ $N$ æ˜¯ $2$ çš„å¹‚ï¼Œæˆ‘ä»¬å°† $x[n]$ åˆ†è§£ä¸ºå¶æ•°ç‚¹å’Œå¥‡æ•°ç‚¹ï¼š

$$
\begin{aligned}
  x_1 [r] &= x[2r]\\
  x_2 [r] &= x[2r+1]
\end{aligned}\; r=0,1,\cdots,\frac{N}{2}-1
$$

ä»è€Œ $X[k]$ å¯ä»¥åˆ†è§£ä¸ºï¼š

$$
\begin{aligned}
  X[k]&=\sum_{n = å¶} x[n] W_N^{kn}+\sum_{n = å¥‡} x[n] W_N^{kn}\\
  &=\sum_{r=0}^{N/2-1} x[2r] W_N^{2kr}+W_N^{k} \sum_{r=0}^{N/2-1} x[2r+1] W_N^{2kr}\\
  &=\sum_{r=0}^{N/2-1} x[2r] (W_N^{2})^{kr}+W_N^{k} \sum_{r=0}^{N/2-1} x[2r+1] (W_N^{2})^{kr}
\end{aligned}
$$

ç”±äº $W_N^2=W_{N/2}$ï¼Œæ‰€ä»¥ï¼ˆæ³¨æ„ $k$ çš„å–å€¼èŒƒå›´ï¼‰ï¼š

$$
\begin{aligned}
  X[k]&=\sum_{r=0}^{N/2-1} x[2r] W_{N/2}^{kr}+W_N^{k} \sum_{r=0}^{N/2-1} x[2r+1] W_{N/2}^{kr}\\
  &=X_1[k]+W_N^k X_2[k] \quad k=0,1,\cdots,N-1
\end{aligned}
$$

æ ¹æ® $W_N^{k+\frac{N}{2}}=-W_N^k$ï¼Œå¦‚æœè¦ç®— $X[k+\frac{N}{2}]$ï¼Œæ˜“å¾—ï¼š

$$
X[k+\frac{N}{2}] = X_1[k]-W_N^k X_2[k] \quad k=0,1,\cdots,N-1
$$

æ€»çš„æ¥è¯´ï¼Œè¿™æ˜¯ä¸€æ¬¡è¶å½¢è¿ç®—ï¼Œè¿ç®—é‡æ˜¯ 1 ä¹˜ 2 åŠ ã€‚

<!-- ![fft-butterfly](/assets/images/fft-butterfly.png) -->

![fft-butterfly](https://i.loli.net/2020/12/03/YgU6vSwOE3kp5uN.png)

åˆ©ç”¨è¿™ä¸ªæ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œé€’å½’ï¼š

$$
\log_2 N
\begin{cases}
\quad\quad\quad\quad N\\
\quad\quad\quad\swarrow \quad\searrow\\
\quad\quad N/2 \quad\; N/2\\
\quad\;\swarrow \quad\searrow \;\; \swarrow \quad\searrow\\
N/4 \;\; N/4 \; N/4 \;\; N/4\\
\quad\quad\quad\quad\;\vdots\\
\end{cases}
$$

æ¯çº§çš„è¶å½¢è¿ç®—æœ‰ $N/2$ ä¸ªï¼Œæ¯ä¸ªè¶å½¢è¿ç®—åŒ…æ‹¬ä¸€ä¸ªå¤æ•°ä¹˜æ³•å’Œä¸¤ä¸ªåŠ æ³•ï¼Œä¸€å…±æœ‰ $\log_2 N$ çº§ï¼Œæ‰€ä»¥å¤æ‚åº¦ä¸º $O(N\log N)$

ä»¥ $N=8$ ä¸ºä¾‹ï¼š

<!-- ![FFT-N=8-é€’å½’](/assets/images/FFT-N=8-é€’å½’.png) -->

|è®¡ç®—æµå›¾|æ ‘å½¢å›¾|
|-------|-----|
|![](images/DIF-FFTè®¡ç®—æµå›¾.png)|![](images/DIT-FFTæ ‘å½¢å›¾.png)|

æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ªæ¯”è¾ƒæœ‰è¶£çš„ä¸œè¥¿ã€‚å°†æ ‘å½¢å›¾ä¸­çš„ç¼–å·å†™æˆäºŒè¿›åˆ¶çš„å½¢å¼ï¼š


<table>
<tr>
  <td style="text-align:center" colspan="1">$X_0=00\red0$</td>
  <td style="text-align:center" colspan="1">$X_1=00\red1$</td>
  <td style="text-align:center" colspan="1">$X_2=01\red0$</td>
  <td style="text-align:center" colspan="1">$X_3=01\red1$</td>
  <td style="text-align:center" colspan="1">$X_4=10\red0$</td>
  <td style="text-align:center" colspan="1">$X_5=10\red1$</td>
  <td style="text-align:center" colspan="1">$X_6=11\red0$</td>
  <td style="text-align:center" colspan="1">$X_7=11\red1$</td>
</tr>
<tr>
  <td style="text-align:center" colspan="4">$00\red0$<br>$01\red0$<br>$10\red0$<br>$11\red0$</td>
  <td style="text-align:center" colspan="4">$00\red1$<br>$01\red1$<br>$10\red1$<br>$11\red1$</td>
</tr>
<tr>
  <td style="text-align:center" colspan="2">$0\red00$<br>$1\red00$</td>
  <td style="text-align:center" colspan="2">$0\red10$<br>$1\red10$</td>
  <td style="text-align:center" colspan="2">$0\red01$<br>$1\red01$</td>
  <td style="text-align:center" colspan="2">$0\red11$<br>$1\red11$</td>
</tr>
<tr>
  <td style="text-align:center" colspan="1">$x_0=\red000$</td>
  <td style="text-align:center" colspan="1">$x_4=\red100$</td>
  <td style="text-align:center" colspan="1">$x_2=\red010$</td>
  <td style="text-align:center" colspan="1">$x_6=\red110$</td>
  <td style="text-align:center" colspan="1">$x_1=\red001$</td>
  <td style="text-align:center" colspan="1">$x_5=\red101$</td>
  <td style="text-align:center" colspan="1">$x_3=\red011$</td>
  <td style="text-align:center" colspan="1">$x_7=\red111$</td>
</tr>
</table>

æ³¨æ„åˆ°ï¼Œä»ä¸Šå¾€ä¸‹å…ˆæ˜¯æŒ‰äºŒè¿›åˆ¶çš„ç¬¬1ä½åˆ†å¥‡å¶ï¼Œç„¶åå†æŒ‰ç¬¬2ä½ã€ç¬¬ä¸‰ä½â€¦â€¦ï¼Œæœ€ç»ˆï¼Œä½¿å¾—æœ€ä¸‹é¢ä¸æœ€ä¸Šé¢çš„äºŒè¿›åˆ¶æ°å¥½â€œå¯¹ç§°â€ï¼Œè¿™ç§°ä¸º **æ¯”ç‰¹é€†åº**ã€‚

å¦‚æœæˆ‘ä»¬å®šä¹‰ç¬¬ $r$ çº§è¶å½¢è¿ç®—çš„è¾“å…¥æ˜¯ $\Psi_r[\alpha]$ å’Œ $\Psi_r[\beta]$ï¼Œå¹¶ä¸”ç‰¹æ®Šçš„ï¼Œå¯¹äºç¬¬ä¸€çº§ï¼Œ$\Psi_r[k]$ å¯¹åº”çš„æ˜¯æ¯”ç‰¹é€†åºçš„ $k$ï¼Œå¯¹äºæœ€åä¸€çº§åˆ™æ˜¯æ­£å¸¸çš„ $k$ã€‚åˆ™æ¯ä¸ªè¶å½¢è¿ç®—å¯ä»¥è¡¨ç¤ºä¸ºï¼š

$$
\displaylines{
\Psi_{r+1}[\alpha] = \Psi_r[\alpha]+W_N^\ell \Psi_r[\beta]\\
\Psi_{r+1}[\beta] = \Psi_r[\alpha]-W_N^\ell \Psi_r[\beta]
}
$$

$\alpha$ï¼Œ$\beta$ï¼Œ$r$ï¼Œ$\ell$ ä¹‹é—´æ»¡è¶³ä¸€äº›å…³ç³»ï¼š

1. $\alpha=a\cdot 2^r+b$ï¼Œå…¶ä¸­ï¼Œ$a=0,1,\cdots,N/2^r-1$ï¼Œè€Œ $b=0,1,\cdots,2^{r-1}-1$
2. $\beta$ ä¸ $\alpha$ ä¸€ä¸€å¯¹åº”ï¼Œ$\beta=\alpha+2^{r-1}$
3. $\ell=b\cdot N/2^r$

æˆ‘æ¨å¯¼ä¸Šé¢çš„å¼å­åªæ˜¯ä¸ºäº†å¥½ç©è€Œå·²ï¼Œè¯¾æœ¬ä¸­æœ‰åº“åˆ©-å›¾åŸºFFTç®—æ³•çš„ä¸€èˆ¬å½¢å¼ã€‚è€ƒè¯•ä¸­æœ€å¥½è¿˜æ˜¯åˆ—è®¡ç®—æµå›¾ã€‚



## DIF-FFT

æŒ‰é¢‘ç‡æŠ½å–ï¼ˆDecimation In Frequencyï¼‰FFT ç®—æ³•å¯ä»¥ç®€å•ç†è§£ä¸º DIT-FFT çš„ç¿»è½¬ç‰ˆã€‚æˆ‘ä»¬ä¸å°† $x[n]$ è¿›è¡Œå¥‡å¶åˆ†è§£ï¼Œè€Œæ˜¯å¯¹ $X[k]$ è¿›è¡Œå¥‡å¶åˆ†è§£ï¼š

$$
\begin{aligned}
X[2r]&=\sum_{n=0}^{N-1} x[n] W_N^{n(2r)}\\
&=\sum_{n=0}^{N/2-1} x[n] W_N^{n(2r)}+\sum_{n=N/2}^{N-1} x[n] W_N^{n(2r)}\\
&=\sum_{n=0}^{N/2-1} x[n] W_N^{n(2r)}+W_N^{Nr}\sum_{n=0}^{N/2-1} x[n+N/2] W_N^{n(2r)}\\
&=\sum_{n=0}^{N/2-1} (x[n]+x[n+N/2]) W_{N/2}^{nr}\,,r=0,1,\cdots,N/2-1
\end{aligned}
$$

$$
\begin{aligned}
X[2r+1]&=\sum_{n=0}^{N-1} x[n] W_N^{n(2r+1)}\\
&=\sum_{n=0}^{N/2-1} x[n] W_N^{n(2r+1)}+\sum_{n=N/2}^{N-1} x[n] W_N^{n(2r+1)}\\
&=\sum_{n=0}^{N/2-1} x[n] W_N^{n(2r+1)}+W_N^{(Nr+N/2)}\sum_{n=0}^{N/2-1} x[n+N/2] W_N^{n(2r+1)}\\
&=\sum_{n=0}^{N/2-1} (x[n]-x[n+N/2]) W_N^r W_{N/2}^{nr}\,,r=0,1,\cdots,N/2-1
\end{aligned}
$$

DIF-FFT ä¸ DIT-FFT è¶å½¢è¿ç®—çš„å¯¹æ¯”å¦‚ä¸‹ï¼š

![](https://www.rfwireless-world.com/images/decimation-in-time-frequency.jpg)

8 ç‚¹ FFT çš„è®¡ç®—æµå›¾å¦‚ä¸‹ï¼š

<!-- ![8-point-Radix-2-FFT-Decimation-in-frequency-form](/assets/images/8-point-Radix-2-FFT-Decimation-in-frequency-form.png) -->

![8-point-Radix-2-FFT-Decimation-in-frequency-form](https://i.loli.net/2020/12/05/ZSvUPcEljrwt1f6.png)

æ³¨æ„åˆ° $x[n]$ æ˜¯æ¯”ç‰¹é¡ºåºï¼Œ$X[k]$ æ˜¯æ¯”ç‰¹é€†åºï¼Œè¿™æ°å¥½ä¸ DIT-FFT ç›¸åã€‚ 

# ç®—æ³•å®ç°

[FFTW](http://www.fftw.org/) æ˜¯ä¸€ä¸ªç”¨äºè®¡ç®— DFT çš„ C è¯­è¨€åº“ï¼Œå®ƒæ˜¯å¼€æºçš„~

# å‚è€ƒ

* è¯¾æœ¬ï¼šæ•°å­—ä¿¡å·å¤„ç†â€”â€”åŸºäºè®¡ç®—æœºçš„æ–¹æ³•ï¼ˆç¬¬å››ç‰ˆï¼‰
* [ä»å¤šé¡¹å¼ä¹˜æ³•åˆ°å¿«é€Ÿå‚…é‡Œå¶å˜æ¢](http://blog.miskcoo.com/2015/04/polynomial-multiplication-and-fast-fourier-transform)
* [å¿«é€Ÿå‚…ç«‹å¶å˜æ¢(FFT)](https://yangyh408.github.io/2019/04/08/%E5%BF%AB%E9%80%9F%E5%82%85%E7%AB%8B%E5%8F%B6%E5%8F%98%E6%8D%A2-FFT/)